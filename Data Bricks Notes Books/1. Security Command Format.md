Access Key command:

spark.conf.set(
    "fs.azure.account.key.<name of datalake storage account>.dfs.core.windows.net",
    "<your Assess key>"

Note: Access key can be retrived from azure main page --> storage account --> seceuirty options

```text
You may have come across HTTP protocol already to access data from a Data Lake. But Microsoft and Databricks, 
recommends using the ABFS or the Azure Blob File System driver, to access data stored in a storage account
from Databricks.
It's a new driver, which is part of the Apache Hadoop suite of products, and it's optimized for big
data analytics workloads and offers better security.
```

ABFS Format

For connection:
```code
abfs[s]://<Container name>@<storage_account_name>.dfs.core.windows.net/

```
****Without giving access keys we cannot generate the connection command, as it is a security feature**** 
Note: Access key can be retrived from azure main page --> storage account --> seceuirty options

For file Accessing: General Information

```code
dbutils.fs.ls("abfss://<folder name>@<data lake name>.dfs.core.windows.net/"
```

For file Accessing: Better Display command

```code
display(dbutils.fs.ls("abfss://<foldername>@<data lake name>.dfs.core.windows.net/"
```

If you want to read the contents of the circuits.csv file, we can use the Spark DataFrame API to do that.

```code
spark.read.csv("abfss://<folder name>@<data lake name>.dfs.core.windows.net/circuits.csv")
```

For file Accessing: Better Display of data frame 

```code
display(spark.read.csv("abfss://<folder name>@<data lake name>.dfs.core.windows.net/circuits.csv"))
```

***REASON for SAS TOKEN***

In summary:
Used the access keys to authenticate to our Azure storage account,
listed files from a container as well as read data from our file,
Considerable Issue with Access Keys is that it gives full access to the entire storage account,

If You would want to restrict access and provide only the required access for your users.
you might want to provide only Read access to your users and also you might want to provide
Access only for a limited period of time.

That's where SAS tokens or Shared Access Signatures come in.
